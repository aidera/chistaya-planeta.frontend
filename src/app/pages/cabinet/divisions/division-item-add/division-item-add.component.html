<div class="cabinet-header">
  <h1>Добавить подразделение</h1>
</div>

<div class="cabinet-content">
  <a class="cabinet-content__backlink" (click)="goToPreviousPage()">← Назад</a>
  <div class="cabinet-content__grid">
    <form
      id="form1"
      [formGroup]="form1"
      (ngSubmit)="sendForm1()"
      class="cabinet-content__grid-item"
      [class.cabinet-content__grid-item_inactive]="activeForm < 1"
    >
      <div
        class="cabinet-content__grid-item-overlay"
        *ngIf="activeForm < 1"
      ></div>
      <mat-card>
        <h2>Основная информация</h2>

        <div class="cabinet-content__grid-item-form-content">
          <app-text-input
            label="Название"
            [control]="form1.get('name')"
            [errorMessages]="{
              required: 'Обязательное поле'
            }"
          >
            <ng-container
              error
              *ngIf="form1.get('name')?.errors?.alreadyExists"
            >
              Такое
              <a [routerLink]="['../../', 'divisions', alreadyExistId]"
                >подразделение</a
              >
              уже существует.
            </ng-container>
          </app-text-input>
        </div>
      </mat-card>
      <div class="cabinet-content__grid-item-actions">
        <button
          mat-raised-button
          color="primary"
          type="submit"
          [class.cabinet-content__grid-item-actions_hidden]="activeForm !== 1"
        >
          Далее
        </button>
      </div>
    </form>

    <form
      id="form2"
      [formGroup]="form2"
      (ngSubmit)="sendForm2()"
      class="cabinet-content__grid-item"
      [class.cabinet-content__grid-item_inactive]="activeForm < 2"
    >
      <div
        class="cabinet-content__grid-item-overlay"
        *ngIf="activeForm !== 1"
      ></div>
      <mat-card>
        <h2>Адрес</h2>

        <div class="cabinet-content__grid-item-form-content">
          <app-select
            [label]="
              isQueryLocality
                ? 'Населённый пункт (добавлено автоматически)'
                : 'Населённый пункт'
            "
            [control]="form2.get('locality')"
            [options]="localitiesOptions"
            [errorMessages]="{
              required: 'Обязательное поле'
            }"
          ></app-select>

          <br /><br />

          <app-text-input
            label="Улица"
            [control]="form2.get('street')"
            [errorMessages]="{
              required: 'Обязательное поле'
            }"
          ></app-text-input>

          <br /><br />

          <app-text-input
            label="Дом"
            [control]="form2.get('house')"
            [errorMessages]="{
              required: 'Обязательное поле'
            }"
          ></app-text-input>
        </div>
      </mat-card>
    </form>
    <div class="clearfix"></div>
  </div>
  <div
    class="cabinet-content__actions"
    [class.cabinet-content__action_inactive]="activeForm < 2"
  >
    <button
      mat-raised-button
      type="submit"
      color="primary"
      [disabled]="isFetching"
      (click)="sendForm2()"
    >
      Добавить
    </button>
  </div>
  <div *ngIf="serverError" class="cabinet-content__bottom-error">
    {{ serverError }}
  </div>
</div>
